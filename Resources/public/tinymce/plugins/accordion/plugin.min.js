tinymce.PluginManager.requireLangPack("accordion");tinymce.PluginManager.add("accordion",function(e){function t(){var t=e.selection;var n=t.getNode();var r=e.dom.getParent(n,"div[data-mce-type=accordion]");var i="",s="";if(r!=null){i=$(r).find("h4.panel-title a").html();s=$(r).find("div.panel-body").html()}e.windowManager.open({title:"Insert accordion",body:[{type:"textbox",name:"title",label:"Title",size:40,value:i},{type:"textbox",multiline:true,name:"text",label:"Content",size:40,minHeight:150,value:s}],onsubmit:function(n){if(r!=null){$(r).find("h4.panel-title a").html(n.data.title);$(r).find("div.panel-body").html(n.data.text)}else{var i="collapse-"+(new Date).getTime();var s='<div data-mce-type="accordion" class="tiny-accordion panel-group" id="accordion">'+'<div class="panel panel-default">'+'<div class="panel-heading">'+'<h4 class="panel-title">'+'<a data-toggle="collapse" data-parent="#accordion" href="#'+i+'">'+n.data.title+"</a>"+"</h4>"+"</div>"+'<div id="'+i+'" class="panel-collapse collapse">'+'<div class="panel-body">'+n.data.text+"</div>";"</div>";"</div>";"</div>";e.insertContent(s);var o=e.dom.get(i);var u=e.dom.getParent(o,"div[data-mce-type=accordion]");var a=e.dom.getNext(u,"*");if(a==null){e.dom.add(e.getBody(),"p","","&nbsp;");a=e.dom.getNext(u,"*")}var f=document.createRange();f.setStart(a,0);f.setEnd(a,0);t.setRng(f)}}})}e.addButton("accordion",{tooltip:"Insert accordion",icon:"none icon-list-alt",stateSelector:"div[data-mce-type=accordion]",onclick:t})});