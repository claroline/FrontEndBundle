!function(tinymce,$){"use strict";tinymce.PluginManager.requireLangPack("accordion","en,es,fr_FR"),tinymce.PluginManager.add("accordion",function(editor){function showDialog(){var selection=editor.selection,selectedElm=selection.getNode(),accordionElm=editor.dom.getParent(selectedElm,"div[data-mce-type=accordion]"),accordionTitle="",accordionText="";null!=accordionElm&&(accordionTitle=$(accordionElm).find("h4.panel-title a").html(),accordionText=$(accordionElm).find("div.panel-body").html()),editor.windowManager.open({title:"Insert accordion",body:[{type:"textbox",name:"title",label:"Title",size:40,value:accordionTitle},{type:"textbox",multiline:!0,name:"text",label:"Content",size:40,minHeight:150,value:accordionText}],onsubmit:function(e){if(null!=accordionElm)$(accordionElm).find("h4.panel-title a").html(e.data.title),$(accordionElm).find("div.panel-body").html(e.data.text);else{var id="collapse-"+(new Date).getTime(),htmlAccordion='<div data-mce-type="accordion" class="tiny-accordion panel-group" id="accordion"><div class="panel panel-default"><div class="panel-heading"><h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#'+id+'">'+e.data.title+'</a></h4></div><div id="'+id+'" class="panel-collapse collapse"><div class="panel-body">'+e.data.text+"</div></div></div></div>";editor.insertContent(htmlAccordion);var panelElt=editor.dom.get(id),accordionElt=editor.dom.getParent(panelElt,"div[data-mce-type=accordion]"),nextElt=editor.dom.getNext(accordionElt,"*");null==nextElt&&(editor.dom.add(editor.getBody(),"p","","&nbsp;"),nextElt=editor.dom.getNext(accordionElt,"*"));var range=document.createRange();range.setStart(nextElt,0),range.setEnd(nextElt,0),selection.setRng(range)}}})}editor.addButton("accordion",{tooltip:"Insert accordion",icon:"fa fa-list-alt",stateSelector:"div[data-mce-type=accordion]",onclick:showDialog})})}(tinymce,jQuery);