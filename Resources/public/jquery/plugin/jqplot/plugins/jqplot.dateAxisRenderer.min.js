(function(h){h.jqplot.DateAxisRenderer=function(){h.jqplot.LinearAxisRenderer.call(this);this.date=new h.jsDate()};var c=1000;var e=60*c;var f=60*e;var l=24*f;var b=7*l;var j=30.4368499*l;var k=365.242199*l;var g=[31,28,31,30,31,30,31,30,31,30,31,30];var i=["%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v","%v"];var m=[l,2*l,3*l,4*l,5*l,6*l,b,8*l,9*l,10*l,11*l,12*l,13*l,2*b,15*l,16*l,17*l,18*l,19*l,20*l,3*b,22*l,23*l,24*l,25*l,26*l,27*l,4*b];var d=[];function a(p,s,t){var o=Number.MAX_VALUE;var u,r,v;for(var q=0,n=m.length;q<n;q++){u=Math.abs(t-m[q]);if(u<o){o=u;r=m[q];v=i[q]}}return[r,v]}h.jqplot.DateAxisRenderer.prototype=new h.jqplot.LinearAxisRenderer();h.jqplot.DateAxisRenderer.prototype.constructor=h.jqplot.DateAxisRenderer;h.jqplot.DateTickFormatter=function(n,o){if(!n){n="%Y/%m/%d"}return h.jsDate.strftime(o,n)};h.jqplot.DateAxisRenderer.prototype.init=function(E){this.tickOptions.formatter=h.jqplot.DateTickFormatter;this.tickInset=0;this.drawBaseline=true;this.baselineWidth=null;this.baselineColor=null;this.daTickInterval=null;this._daTickInterval=null;h.extend(true,this,E);var C=this._dataBounds,u,x,D,y,A,z,o;for(var t=0;t<this._series.length;t++){u={intervals:[],frequencies:{},sortedIntervals:[],min:null,max:null,mean:null};x=0;D=this._series[t];y=D.data;A=D._plotData;z=D._stackData;o=0;for(var r=0;r<y.length;r++){if(this.name=="xaxis"||this.name=="x2axis"){y[r][0]=new h.jsDate(y[r][0]).getTime();A[r][0]=new h.jsDate(y[r][0]).getTime();z[r][0]=new h.jsDate(y[r][0]).getTime();if((y[r][0]!=null&&y[r][0]<C.min)||C.min==null){C.min=y[r][0]}if((y[r][0]!=null&&y[r][0]>C.max)||C.max==null){C.max=y[r][0]}if(r>0){o=Math.abs(y[r][0]-y[r-1][0]);u.intervals.push(o);if(u.frequencies.hasOwnProperty(o)){u.frequencies[o]+=1}else{u.frequencies[o]=1}}x+=o}else{y[r][1]=new h.jsDate(y[r][1]).getTime();A[r][1]=new h.jsDate(y[r][1]).getTime();z[r][1]=new h.jsDate(y[r][1]).getTime();if((y[r][1]!=null&&y[r][1]<C.min)||C.min==null){C.min=y[r][1]}if((y[r][1]!=null&&y[r][1]>C.max)||C.max==null){C.max=y[r][1]}if(r>0){o=Math.abs(y[r][1]-y[r-1][1]);u.intervals.push(o);if(u.frequencies.hasOwnProperty(o)){u.frequencies[o]+=1}else{u.frequencies[o]=1}}}x+=o}if(D.renderer.bands){if(D.renderer.bands.hiData.length){var w=D.renderer.bands.hiData;for(var r=0,q=w.length;r<q;r++){if(this.name==="xaxis"||this.name==="x2axis"){w[r][0]=new h.jsDate(w[r][0]).getTime();if((w[r][0]!=null&&w[r][0]>C.max)||C.max==null){C.max=w[r][0]}}else{w[r][1]=new h.jsDate(w[r][1]).getTime();if((w[r][1]!=null&&w[r][1]>C.max)||C.max==null){C.max=w[r][1]}}}}if(D.renderer.bands.lowData.length){var w=D.renderer.bands.lowData;for(var r=0,q=w.length;r<q;r++){if(this.name==="xaxis"||this.name==="x2axis"){w[r][0]=new h.jsDate(w[r][0]).getTime();if((w[r][0]!=null&&w[r][0]<C.min)||C.min==null){C.min=w[r][0]}}else{w[r][1]=new h.jsDate(w[r][1]).getTime();if((w[r][1]!=null&&w[r][1]<C.min)||C.min==null){C.min=w[r][1]}}}}}var B=0,v=0;for(var p in u.frequencies){u.sortedIntervals.push({interval:p,frequency:u.frequencies[p]})}u.sortedIntervals.sort(function(s,n){return n.frequency-s.frequency});u.min=h.jqplot.arrayMin(u.intervals);u.max=h.jqplot.arrayMax(u.intervals);u.mean=x/y.length;this._intervalStats.push(u);u=x=D=y=A=z=null}C=null};h.jqplot.DateAxisRenderer.prototype.reset=function(){this.min=this._options.min;this.max=this._options.max;this.tickInterval=this._options.tickInterval;this.numberTicks=this._options.numberTicks;this._autoFormatString="";if(this._overrideFormatString&&this.tickOptions&&this.tickOptions.formatString){this.tickOptions.formatString=""}this.daTickInterval=this._daTickInterval};h.jqplot.DateAxisRenderer.prototype.createTicks=function(p){var aa=this._ticks;var M=this.ticks;var G=this.name;var I=this._dataBounds;var N=this._intervalStats;var n=(this.name.charAt(0)==="x")?this._plotDimensions.width:this._plotDimensions.height;var w;var ai,K;var y,x;var ah,ad;var s=30;var Q=1;var Y=null;var P=[];if(this.tickInterval!=null){if(Number(this.tickInterval)){Y=[Number(this.tickInterval),"seconds"]}else{if(typeof this.tickInterval=="string"){var ag=this.tickInterval.split(" ");if(ag.length==1){Y=[1,ag[0]]}else{if(ag.length==2){Y=[ag[0],ag[1]]}}}}}var v=this.tickInterval;ai=new h.jsDate((this.min!=null)?this.min:I.min).getTime();K=new h.jsDate((this.max!=null)?this.max:I.max).getTime();var A=p.plugins.cursor;if(A&&A._zoom&&A._zoom.zooming){this.min=null;this.max=null}var B=K-ai;if(this.tickOptions==null||!this.tickOptions.formatString){this._overrideFormatString=true}if(M.length){for(ad=0;ad<M.length;ad++){var R=M[ad];var ab=new this.tickRenderer(this.tickOptions);if(R.constructor==Array){ab.value=new h.jsDate(R[0]).getTime();ab.label=R[1];if(!this.showTicks){ab.showLabel=false;ab.showMark=false}else{if(!this.showTickMarks){ab.showMark=false}}ab.setTick(ab.value,this.name);var U=ab.getLabel();if(h.inArray(U,P)==-1){this._ticks.push(ab);P.push(U)}}else{ab.value=new h.jsDate(R).getTime();if(!this.showTicks){ab.showLabel=false;ab.showMark=false}else{if(!this.showTickMarks){ab.showMark=false}}ab.setTick(ab.value,this.name);var U=ab.getLabel();if(h.inArray(U,P)==-1){this._ticks.push(ab);P.push(U)}}}this.numberTicks=M.length;this.min=this._ticks[0].value;this.max=this._ticks[this.numberTicks-1].value;this.daTickInterval=[(this.max-this.min)/(this.numberTicks-1)/1000,"seconds"]}else{if(this.min==null&&this.max==null&&I.min==I.max){var F=h.extend(true,{},this.tickOptions,{name:this.name,value:null});var W=300000;this.min=I.min-W;this.max=I.max+W;this.numberTicks=3;for(var ad=this.min;ad<=this.max;ad+=W){F.value=ad;var ab=new this.tickRenderer(F);if(this._overrideFormatString&&this._autoFormatString!=""){ab.formatString=this._autoFormatString}ab.showLabel=false;ab.showMark=false;var U=ab.getLabel();if(h.inArray(U,P)==-1){this._ticks.push(ab);P.push(U)}}if(this.showTicks){this._ticks[1].showLabel=true}if(this.showTickMarks){this._ticks[1].showTickMarks=true}}else{if(this.min==null&&this.max==null){var O=h.extend(true,{},this.tickOptions,{name:this.name,value:null});var af,J;if(!this.tickInterval&&!this.numberTicks){var T=Math.max(n,s+1);var ac=115;if(this.tickRenderer===h.jqplot.CanvasAxisTickRenderer&&this.tickOptions.angle){ac=115-40*Math.abs(Math.sin(this.tickOptions.angle/180*Math.PI))}af=Math.ceil((T-s)/ac+1);J=(K-ai)/(af-1)}else{if(this.tickInterval){J=new h.jsDate(0).add(Y[0],Y[1]).getTime()}else{if(this.numberTicks){af=this.numberTicks;J=(K-ai)/(Math.max(1,af-1))}}}if(J<=27*l){var S=a(ai,K,J);var r=S[0];this._autoFormatString=S[1];ai=new h.jsDate(ai).setHours(0,0,0,0);ai=ai.getTime();af=Math.ceil((K-ai)/r)+1;this.min=ai;this.max=ai+(af-1)*r;var ae=this.max-K;var C=Math.floor(ae/r);if(ae>0&&C>0){this.max-=C*r;af-=C*1}if(this.max<K){this.max+=r;af+=1}this.tickInterval=r;this.numberTicks=af;for(var ad=0;ad<af;ad++){O.value=this.min+ad*r;ab=new this.tickRenderer(O);if(this._overrideFormatString&&this._autoFormatString!=""){ab.formatString=this._autoFormatString}if(!this.showTicks){ab.showLabel=false;ab.showMark=false}else{if(!this.showTickMarks){ab.showMark=false}}var U=ab.getLabel();if(h.inArray(U,P)==-1){this._ticks.push(ab);P.push(U)}}Q=this.tickInterval}else{if(J<=11*j){this._autoFormatString="%v";var E=Math.round(J/j);if(E<1){E=1}var X=new h.jsDate(ai).setDate(1).setHours(0,0,0,0);var q=new h.jsDate(K);var z=new h.jsDate(K).setDate(1).setHours(0,0,0,0);if(q.getTime()!==z.getTime()){z=z.add(1,"month")}var V=z.diff(X.getTime(),"month");af=Math.ceil(V/E)+1;this.min=X.getTime();this.max=X.clone().add((af-1)*E,"month").getTime();this.numberTicks=af;for(var ad=0;ad<af;ad++){if(ad===0){O.value=X.getTime()}else{O.value=X.add(E,"month").getTime()}ab=new this.tickRenderer(O);if(this._overrideFormatString&&this._autoFormatString!=""){ab.formatString=this._autoFormatString}if(!this.showTicks){ab.showLabel=false;ab.showMark=false}else{if(!this.showTickMarks){ab.showMark=false}}var U=ab.getLabel();if(h.inArray(U,P)==-1){this._ticks.push(ab);P.push(U)}}Q=E*j}else{this._autoFormatString="%v";var E=Math.round(J/k);if(E<1){E=1}var X=new h.jsDate(ai).setMonth(0,1).setHours(0,0,0,0);var z=new h.jsDate(K).add(1,"year").setMonth(0,1).setHours(0,0,0,0);var L=z.diff(X.getTime(),"year");af=Math.ceil(L/E)+1;this.min=X.getTime();this.max=X.clone().add((af-1)*E,"year").getTime();this.numberTicks=af;for(var ad=0;ad<af;ad++){if(ad===0){O.value=X.getTime()}else{O.value=X.add(E,"year").getTime()}ab=new this.tickRenderer(O);if(this._overrideFormatString&&this._autoFormatString!=""){ab.formatString=this._autoFormatString}if(!this.showTicks){ab.showLabel=false;ab.showMark=false}else{if(!this.showTickMarks){ab.showMark=false}}var U=ab.getLabel();if(h.inArray(U,P)==-1){this._ticks.push(ab);P.push(U)}}Q=E*k}}}else{if(G=="xaxis"||G=="x2axis"){n=this._plotDimensions.width}else{n=this._plotDimensions.height}if(this.min!=null&&this.max!=null&&this.numberTicks!=null){this.tickInterval=null}if(this.tickInterval!=null&&Y!=null){this.daTickInterval=Y}if(ai==K){var o=24*60*60*500;ai-=o;K+=o}B=K-ai;var H=2+parseInt(Math.max(0,n-100)/100,10);var Z,D;Z=(this.min!=null)?new h.jsDate(this.min).getTime():ai-B/2*(this.padMin-1);D=(this.max!=null)?new h.jsDate(this.max).getTime():K+B/2*(this.padMax-1);this.min=Z;this.max=D;B=this.max-this.min;if(this.numberTicks==null){if(this.daTickInterval!=null){var u=new h.jsDate(this.max).diff(this.min,this.daTickInterval[1],true);this.numberTicks=Math.ceil(u/this.daTickInterval[0])+1;this.max=new h.jsDate(this.min).add((this.numberTicks-1)*this.daTickInterval[0],this.daTickInterval[1]).getTime()}else{if(n>200){this.numberTicks=parseInt(3+(n-200)/100,10)}else{this.numberTicks=2}}}Q=B/(this.numberTicks-1)/1000;if(this.daTickInterval==null){this.daTickInterval=[Q,"seconds"]}for(var ad=0;ad<this.numberTicks;ad++){var ai=new h.jsDate(this.min);ah=ai.add(ad*this.daTickInterval[0],this.daTickInterval[1]).getTime();var ab=new this.tickRenderer(this.tickOptions);if(!this.showTicks){ab.showLabel=false;ab.showMark=false}else{if(!this.showTickMarks){ab.showMark=false}}ab.setTick(ah,this.name);var U=ab.getLabel();if(h.inArray(U,P)==-1){this._ticks.push(ab);P.push(U)}}}}}if(this.tickInset){this.min=this.min-this.tickInset*Q;this.max=this.max+this.tickInset*Q}if(this._daTickInterval==null){this._daTickInterval=this.daTickInterval}aa=null;P=[]}})(jQuery);